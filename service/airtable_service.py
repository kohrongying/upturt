from typing import List

from pyairtable import Table

from domain.health_check import HealthCheck
from pydantic import validate_arguments
import os

api_key = os.environ["AIRTABLE_API_KEY"]
base_id = 'apph8KjTUqc4kP4wj'
status_table_name = 'Status'
status_table = Table(api_key, base_id, status_table_name)


class AirtableService:

    @validate_arguments
    def batch_create_health_check(self, health_check_records: List[HealthCheck]) -> None:
        try:
            response = status_table.batch_create([hc.to_airtable_model() for hc in health_check_records])
            print(response)
        except Exception:
            return None
